{{extend 'layout.html'}}

<div class="container">
  <div class="row">
    <div class="col-md-offset-1 col-md-10">
      {{if response.flash:}}
      <div class="alert alert-danger">{{=response.flash}}</div>
      {{else:}}
      <div class="alert">Use the form below to update your selected item</div>
      {{pass}}
      <div class="form-horizontal">
        {{=updateobjectform.custom.begin}}
        <h2>General</h2>
        <div class="form-group {{if updateobjectform.errors['name']:}}has-error{{pass}}">
          <div class="col-xs-12">{{=updateobjectform.custom.label.name}}</div>
          <div class="col-sm-8 col-xs-12 help-block">{{=updateobjectform.custom.widget.name}}</div>
          <div class="col-sm-4 col-xs-12 form-helper">{{=updateobjectform.custom.comment.name}}</div>
        </div>
        <div class="form-group {{if updateobjectform.errors['collection']:}}has-error{{pass}}">
          <div class="col-xs-12">{{=updateobjectform.custom.label.collection}}</div>
          <div class="col-sm-8 col-xs-12 help-block">{{=updateobjectform.custom.widget.collection}}</div>
          <div class="col-sm-4 col-xs-12 form-helper">{{=updateobjectform.custom.comment.collection}}</div>
        </div>
        <div class = "form-group {{if updateobjectform.errors['description']:}}has-error{{pass}}">
          <div class = "col-xs-12">{{=updateobjectform.custom.label.description}}</div>
          <div class = "col-sm-8 col-xs-12 help-block">{{=updateobjectform.custom.widget.description}}</div>
          <div class = "col-sm-4 col-xs-12 form-helper">{{=updateobjectform.custom.comment.description}}</div>
        </div>
        <h2>Details</h2>
        <div class="form-group {{if updateobjectform.errors['price']:}}has-error{{pass}}">
          <div class="col-xs-12">{{=updateobjectform.custom.label.price}}</div>
          <div class="col-sm-8 col-xs-12 help-block">
            <div class="input-group">
              <span class="input-group-addon">&pound;</span>
              {{=updateobjectform.custom.widget.price}}
            </div>
          </div>
          <div class="col-sm-4 col-xs-12 form-helper">{{=updateobjectform.custom.comment.price}}</div>
        </div>
        <div class = "form-group {{if updateobjectform.errors['category']:}}has-error{{pass}}">
          <div class = "col-xs-12">{{=updateobjectform.custom.label.category}}</div>
          <div class = "col-sm-8 col-xs-12 help-block">{{=updateobjectform.custom.widget.category}}</div>
          <div class = "col-sm-4 col-xs-12 form-helper">{{=updateobjectform.custom.comment.category}}</div>
        </div>
        <div class = "form-group {{if updateobjectform.errors['image']:}}has-error{{pass}}">
          <div class = "col-xs-12">{{=updateobjectform.custom.label.image}}</div>
          <div class = "col-sm-8 col-xs-12 help-block">{{=updateobjectform.custom.widget.image}}</div>
          <div class = "col-sm-4 col-xs-12 form-helper">{{=updateobjectform.custom.comment.image}}</div>
          <div class = "col-xs-12"><img hidden="hidden" id="object_image_preview" src=""/></div>
        </div>
        <h2>Trading</h2>
        <div class = "form-group {{if updateobjectform.errors['quantity']:}}has-error{{pass}}">
          <div class = "col-xs-12">Item Quantity</div>
          <div class = "col-sm-8 col-xs-12 help-block">{{=updateobjectform.custom.widget.quantity}}</div>
          <div class = "col-sm-4 col-xs-12 form-helper">Please enter the number of this item that you wish to add.</div>
        </div>
        
        <div class = "form-group">
          <div class = "col-xs-12">Do you wish to trade this item?</div>
          <div class = "col-sm-8 col-xs-12 help-block">
            <select id = "select_item_tradable" class="form-control">
              <option selected="selected">No</option>
              <option>Yes</option>
            </select>
          </div>
          <div class = "col-sm-4 col-xs-12 form-helper">Select whether you are looking to trade this item.</div>
        </div>
        <div id = "tradable_quantity" class = "form-group {{if updateobjectform.errors['tradable_quantity']:}}has-error{{pass}}">
          <div class = "col-xs-12">Quantity to Trade</div>
          <div class = "col-sm-8 col-xs-12 help-block">{{=updateobjectform.custom.widget.tradable_quantity}}</div>
          <div class = "col-sm-4 col-xs-12 form-helper">Enter the quantity of this item that you would like to trade.</div>
        </div>

        <div class = "form-group">
          <div class = "col-xs-12">Are you looking for this item?</div>
          <div class = "col-sm-8 col-xs-12 help-block">
            <select id = "select_item_wanted" class="form-control">
              <option selected="selected">No</option>
              <option>Yes</option>
            </select>
          </div>
          <div class = "col-sm-4 col-xs-12 form-helper">Select whether you are looking to find (more) of this item.</div>
        </div>
        <div id = "wanted_quantity" class = "form-group {{if updateobjectform.errors['wanted_quantity']:}}has-error{{pass}}">
          <div class = "col-xs-12">Quantity Wanted</div>
          <div class = "col-sm-8 col-xs-12 help-block">{{=updateobjectform.custom.widget.wanted_quantity}}</div>
          <div class = "col-sm-4 col-xs-12 form-helper">Enter the number of this item that you would like to get.</div>
        </div>

        <div class = "form_field">
          <div class = "col-md-offset-3 col-xs-12 col-sm-2"><a class = "btn btn-danger cancel_button" href="{{=URL('object', 'canceledit', args =[record.id])}}">Cancel</a></div>
          <div class = "col-md-offset-2 col-xs-12 col-sm-2">{{=updateobjectform.custom.submit}}</div>
        </div>
        <div class="clearfix"></div>
        {{=updateobjectform.custom.end}}
      </div>
    </div>
  </div>
</div>

{{block page_js}}
<script src="{{=URL('static', 'js/image-preview.js')}}" type="text/javascript"></script>
<script>
$(function() {
  {{if record.tradable_quantity > 0 or updateobjectform.errors['tradable_quantity']:}}
  $('#select_item_tradable').val('Yes');
  {{else:}}
  $('#tradable_quantity').hide();
  {{pass}}

  {{if updateobjectform.errors['wanted_quantity']:}}
  $('#select_item_wanted').val('Yes');
  {{else:}}
  $('#wanted_quantity').hide();
  {{pass}}

  $('#select_item_tradable').change(function() {
    if ($(this).val() == 'Yes') {
      $('#tradable_quantity').show();
    } else {
      $('#tradable_quantity').hide();
      $('#object_tradable_quantity').val(0);
    }
  });

  $('#select_item_wanted').change(function() {
    if ($(this).val() == 'Yes') {
      $('#wanted_quantity').show();
    } else {
      $('#wanted_quantity').hide();
      $('#object_wanted_quantity').val(0);
    }
  });
});
$("#object_image").change(function() {
  load_image_preview(this, '#object_image_preview');
});
</script>
{{end page_js}}
